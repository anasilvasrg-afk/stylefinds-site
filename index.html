<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daily Fashion Finds - Shop the Trendiest Styles</title>
    <meta name="description" content="Discover daily fashion finds and shop curated outfits by season. Find the perfect look and shop directly on Amazon.">
    <meta property="og:title" content="Daily Fashion Finds - Shop the Trendiest Styles">
    <meta property="og:description" content="Discover daily fashion finds and shop curated outfits by season.">
    <meta property="og:type" content="website">
    <meta property="og:image" content="">
    <meta property="og:url" content="">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Daily Fashion Finds - Shop the Trendiest Styles">
    <meta name="twitter:description" content="Discover daily fashion finds and shop curated outfits by season.">
    <meta name="twitter:image" content="">
    
    <!-- Preconnect for faster loading -->
    <link rel="preconnect" href="https://www.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://firebasestorage.googleapis.com" crossorigin>
    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <!-- Fonts - loaded early -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500&display=swap" as="style">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500&family=Playfair+Display:ital,wght@0,400;0,500;1,400&display=swap" rel="stylesheet">
    
    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        body { font-family: 'Inter', sans-serif; transition: background-color 0.3s, color 0.3s; }
        .masonry-grid { column-count: 2; column-gap: 0.75rem; }
        @media (min-width: 640px) { .masonry-grid { column-count: 3; column-gap: 0.75rem; } }
        @media (min-width: 1024px) { .masonry-grid { column-count: 4; column-gap: 1rem; } }
        @media (min-width: 1280px) { .masonry-grid { column-count: 5; column-gap: 1rem; } }
        .masonry-item { break-inside: avoid; margin-bottom: 0.5rem; }
        @media (min-width: 1024px) { .masonry-item { margin-bottom: 0.75rem; } }
        .line-clamp-2 { display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
        .masonry-item img { width: 100%; aspect-ratio: 2/3; object-fit: cover; border-radius: 0.5rem; }
        .style-notes { font-family: 'Playfair Display', serif; }
        
        /* Loading screen */
        .initial-loader {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: white; display: flex; flex-direction: column;
            align-items: center; justify-content: center; z-index: 9999;
            transition: opacity 0.3s ease-out;
        }
        .initial-loader.fade-out { opacity: 0; pointer-events: none; }
        .loader-spinner {
            width: 40px; height: 40px; border: 3px solid #e5e5e5;
            border-top-color: #78716c; border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { to { transform: rotate(360deg); } }
        
        /* Dark Mode */
        .dark { background-color: #171717; color: #e5e5e5; }
        .dark .initial-loader { background-color: #171717; }
        .dark .loader-spinner { border-color: #404040; border-top-color: #a3a3a3; }
    </style>
</head>
<body class="bg-white">
    <!-- Loading Screen -->
    <div id="initial-loader" class="initial-loader">
        <div class="loader-spinner"></div>
        <p style="margin-top: 16px; color: #78716c; font-size: 14px; letter-spacing: 0.1em;">STYLE FINDS</p>
    </div>
    
    <div id="root"></div>

    <!-- Firebase - Load async -->
    <script>
        // Load Firebase scripts dynamically
        function loadScript(src) {
            return new Promise((resolve, reject) => {
                const script = document.createElement('script');
                script.src = src;
                script.onload = resolve;
                script.onerror = reject;
                document.head.appendChild(script);
            });
        }
        
        async function initFirebase() {
            await loadScript('https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js');
            await loadScript('https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore-compat.js');
            await loadScript('https://www.gstatic.com/firebasejs/10.7.0/firebase-auth-compat.js');
            await loadScript('https://www.gstatic.com/firebasejs/10.7.0/firebase-storage-compat.js');
            
            firebase.initializeApp({
                apiKey: "AIzaSyAgBxBaVmC07cJJCnoSmxhNFx_-dd3Cbds",
                authDomain: "shop-website-c1a5f.firebaseapp.com",
                projectId: "shop-website-c1a5f",
                storageBucket: "shop-website-c1a5f.firebasestorage.app",
                messagingSenderId: "303465721440",
                appId: "1:303465721440:web:74dd05748db813c8bc9d05"
            });
            
            window.db = firebase.firestore();
            window.auth = firebase.auth();
            window.storage = firebase.storage();
            
            // Load React and the app
            await loadScript('https://unpkg.com/react@18/umd/react.production.min.js');
            await loadScript('https://unpkg.com/react-dom@18/umd/react-dom.production.min.js');
            await loadScript('https://unpkg.com/@babel/standalone/babel.min.js');
            
            // Now load the app
            loadApp();
        }
        
        initFirebase();
    </script>

    <script type="text/babel" id="app-script">
        function loadApp() {
            const { useState, useMemo, useEffect } = React;
            
            const trackEvent = (name, data = {}) => console.log('Analytics:', name, data);
            
            // Icons
            const ChevronLeft = () => (<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="15 18 9 12 15 6"></polyline></svg>);
            const Pin = () => (<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="12" y1="17" x2="12" y2="22"></line><path d="M5 17h14v-1.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V6h1a2 2 0 0 0 0-4H8a2 2 0 0 0 0 4h1v4.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24Z"></path></svg>);
            const ArrowUp = () => (<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="12" y1="19" x2="12" y2="5"></line><polyline points="5 12 12 5 19 12"></polyline></svg>);
            const Copy = () => (<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>);
            const Check = () => (<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="20 6 9 17 4 12"></polyline></svg>);
            const Share2 = () => (<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="18" cy="5" r="3"></circle><circle cx="6" cy="12" r="3"></circle><circle cx="18" cy="19" r="3"></circle><line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line><line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line></svg>);
            const Search = () => (<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.35-4.35"></path></svg>);
            const Plus = () => (<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>);
            const Trash = () => (<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>);
            const Edit = () => (<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg>);
            const X = () => (<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>);
            const Moon = () => (<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>);
            const Sun = () => (<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>);
            const Duplicate = () => (<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>);

            // Optimized Image Component
            const OptimizedImage = ({ src, alt, className, style }) => {
                const [loading, setLoading] = useState(true);
                const [error, setError] = useState(false);
                return (
                    <div className="relative">
                        {loading && <div className="absolute inset-0 bg-stone-200 dark:bg-neutral-700 animate-pulse" />}
                        {error ? (
                            <div className="absolute inset-0 bg-stone-100 dark:bg-neutral-800 flex items-center justify-center">
                                <span className="text-stone-400 text-sm">Image unavailable</span>
                            </div>
                        ) : (
                            <img src={src} alt={alt} className={className} style={style} loading="lazy" decoding="async"
                                onLoad={() => setLoading(false)} onError={() => { setLoading(false); setError(true); }} />
                        )}
                    </div>
                );
            };

            // Admin Login
            const AdminLogin = ({ onLogin, onClose }) => {
                const [email, setEmail] = useState('');
                const [password, setPassword] = useState('');
                const [error, setError] = useState('');
                const [loading, setLoading] = useState(false);

                const handleSubmit = async (e) => {
                    e.preventDefault();
                    setLoading(true);
                    setError('');
                    try {
                        await auth.signInWithEmailAndPassword(email, password);
                        onLogin();
                    } catch (err) { setError(err.message); }
                    setLoading(false);
                };

                return (
                    <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4">
                        <div className="bg-white dark:bg-neutral-800 rounded-2xl p-6 w-full max-w-md relative">
                            <button onClick={onClose} className="absolute top-4 right-4 text-stone-500"><X /></button>
                            <h2 className="text-2xl font-light mb-6 text-center dark:text-white">Admin Login</h2>
                            <form onSubmit={handleSubmit} className="space-y-4">
                                <input type="email" placeholder="Email" value={email} onChange={(e) => setEmail(e.target.value)} className="w-full p-3 border border-stone-200 rounded-lg dark:bg-neutral-700 dark:border-neutral-600 dark:text-white" required />
                                <input type="password" placeholder="Password" value={password} onChange={(e) => setPassword(e.target.value)} className="w-full p-3 border border-stone-200 rounded-lg dark:bg-neutral-700 dark:border-neutral-600 dark:text-white" required />
                                {error && <p className="text-red-500 text-sm">{error}</p>}
                                <button type="submit" disabled={loading} className="w-full py-3 bg-stone-800 text-white rounded-lg hover:bg-stone-900 disabled:opacity-50 dark:bg-neutral-600">
                                    {loading ? 'Logging in...' : 'Login'}
                                </button>
                            </form>
                        </div>
                    </div>
                );
            };

            // Outfit Modal
            const OutfitModal = ({ outfit, onSave, onClose, darkMode }) => {
                const [formData, setFormData] = useState(outfit || {
                    mainImage: '', season: 'fall', slug: '', seoTitle: '', metaDescription: '', mainImageAlt: '', fullSeoDescription: '', outfitCode: '', items: []
                });
                const [newItem, setNewItem] = useState({ name: '', image: '', link: '', altText: '' });
                const [saving, setSaving] = useState(false);
                const [uploading, setUploading] = useState(false);
                const [uploadingItem, setUploadingItem] = useState(false);

                const generateSlug = (text) => text.toLowerCase().replace(/[^a-z0-9]+/g, '-').replace(/(^-|-$)/g, '');
                const autoGenerateSlug = (code, title, season) => {
                    const parts = [];
                    if (code) parts.push(code);
                    if (title) parts.push(generateSlug(title));
                    else parts.push(season + '-outfit');
                    return parts.join('-');
                };

                useEffect(() => {
                    if (!outfit || outfit._isDuplicate) {
                        const newSlug = autoGenerateSlug(formData.outfitCode, formData.seoTitle, formData.season);
                        setFormData(prev => ({ ...prev, slug: newSlug }));
                    }
                }, [formData.outfitCode, formData.seoTitle, formData.season]);

                const compressImage = (file, maxWidth = 1200, quality = 0.85) => {
                    return new Promise((resolve) => {
                        const reader = new FileReader();
                        reader.onload = (e) => {
                            const img = new Image();
                            img.onload = () => {
                                const canvas = document.createElement('canvas');
                                let width = img.width, height = img.height;
                                if (width > maxWidth) { height = (height * maxWidth) / width; width = maxWidth; }
                                canvas.width = width; canvas.height = height;
                                canvas.getContext('2d').drawImage(img, 0, 0, width, height);
                                canvas.toBlob((blob) => resolve(new File([blob], file.name, { type: 'image/jpeg' })), 'image/jpeg', quality);
                            };
                            img.src = e.target.result;
                        };
                        reader.readAsDataURL(file);
                    });
                };

                const handleMainImageUpload = async (e) => {
                    const file = e.target.files[0];
                    if (!file || !file.type.startsWith('image/')) return;
                    setUploading(true);
                    try {
                        const compressed = await compressImage(file, 1200, 0.85);
                        const ref = storage.ref().child(`outfits/${Date.now()}_${file.name.replace(/\.[^/.]+$/, '')}.jpg`);
                        await ref.put(compressed);
                        const url = await ref.getDownloadURL();
                        setFormData({ ...formData, mainImage: url });
                    } catch (err) { alert('Upload failed: ' + err.message); }
                    setUploading(false);
                };

                const handleItemImageUpload = async (e) => {
                    const file = e.target.files[0];
                    if (!file || !file.type.startsWith('image/')) return;
                    setUploadingItem(true);
                    try {
                        const compressed = await compressImage(file, 800, 0.8);
                        const ref = storage.ref().child(`products/${Date.now()}_${file.name.replace(/\.[^/.]+$/, '')}.jpg`);
                        await ref.put(compressed);
                        const url = await ref.getDownloadURL();
                        setNewItem({ ...newItem, image: url });
                    } catch (err) { alert('Upload failed: ' + err.message); }
                    setUploadingItem(false);
                };

                const addItem = () => {
                    if (newItem.name && newItem.image && newItem.link) {
                        setFormData({ ...formData, items: [...formData.items, { ...newItem }] });
                        setNewItem({ name: '', image: '', link: '', altText: '' });
                    }
                };

                const removeItem = (idx) => setFormData({ ...formData, items: formData.items.filter((_, i) => i !== idx) });

                const handleSave = async () => {
                    if (!formData.mainImage) { alert('Please add a main image'); return; }
                    setSaving(true);
                    const finalSlug = formData.slug || autoGenerateSlug(formData.outfitCode, formData.seoTitle, formData.season);
                    const data = { ...formData, slug: finalSlug, dateAdded: outfit?.dateAdded || new Date().toISOString() };
                    await onSave(data);
                    setSaving(false);
                };

                const modalBg = darkMode ? 'bg-neutral-800' : 'bg-white';
                const textColor = darkMode ? 'text-white' : 'text-stone-800';
                const inputBg = darkMode ? 'bg-neutral-700 border-neutral-600 text-white' : 'bg-white border-stone-200';

                return (
                    <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4 overflow-y-auto">
                        <div className={`${modalBg} rounded-2xl p-6 w-full max-w-2xl my-8 relative max-h-[90vh] overflow-y-auto`}>
                            <button onClick={onClose} className="absolute top-4 right-4 text-stone-500"><X /></button>
                            <h2 className={`text-2xl font-light mb-6 ${textColor}`}>{outfit && !outfit._isDuplicate ? 'Edit Outfit' : 'Add New Outfit'}</h2>
                            <div className="space-y-4">
                                <div>
                                    <label className={`block text-sm font-medium ${textColor} mb-2`}>Main Outfit Image *</label>
                                    <input type="file" accept="image/*" onChange={handleMainImageUpload} className={`w-full p-2 border rounded-lg text-sm ${inputBg}`} />
                                    {uploading && <p className="text-xs text-stone-500 mt-1">Uploading...</p>}
                                    <input type="text" placeholder="Or paste image URL" value={formData.mainImage} onChange={(e) => setFormData({ ...formData, mainImage: e.target.value })} className={`w-full mt-2 p-2 border rounded-lg text-sm ${inputBg}`} />
                                    {formData.mainImage && <img src={formData.mainImage} alt="Preview" className="mt-2 w-32 h-40 object-cover rounded" />}
                                </div>
                                <div className="grid grid-cols-2 gap-4">
                                    <div>
                                        <label className={`block text-sm font-medium ${textColor} mb-2`}>Season</label>
                                        <select value={formData.season} onChange={(e) => setFormData({ ...formData, season: e.target.value })} className={`w-full p-2 border rounded-lg ${inputBg}`}>
                                            <option value="spring">Spring</option><option value="summer">Summer</option><option value="fall">Fall</option><option value="winter">Winter</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label className={`block text-sm font-medium ${textColor} mb-2`}>Outfit Code</label>
                                        <input type="text" value={formData.outfitCode} onChange={(e) => setFormData({ ...formData, outfitCode: e.target.value })} className={`w-full p-2 border rounded-lg ${inputBg}`} placeholder="e.g., 1225" />
                                    </div>
                                </div>
                                <div>
                                    <label className={`block text-sm font-medium ${textColor} mb-2`}>URL Slug</label>
                                    <input type="text" value={formData.slug} onChange={(e) => setFormData({ ...formData, slug: e.target.value })} className={`w-full p-2 border rounded-lg bg-stone-50 ${inputBg}`} />
                                </div>
                                <div>
                                    <label className={`block text-sm font-medium ${textColor} mb-2`}>SEO Title ({formData.seoTitle?.length || 0}/60)</label>
                                    <input type="text" value={formData.seoTitle} onChange={(e) => setFormData({ ...formData, seoTitle: e.target.value })} className={`w-full p-2 border rounded-lg ${inputBg}`} maxLength={60} />
                                </div>
                                <div>
                                    <label className={`block text-sm font-medium ${textColor} mb-2`}>Meta Description ({formData.metaDescription?.length || 0}/160)</label>
                                    <textarea value={formData.metaDescription} onChange={(e) => setFormData({ ...formData, metaDescription: e.target.value })} className={`w-full p-2 border rounded-lg ${inputBg}`} rows={2} maxLength={160} />
                                </div>
                                <div>
                                    <label className={`block text-sm font-medium ${textColor} mb-2`}>Main Image Alt Text</label>
                                    <input type="text" value={formData.mainImageAlt} onChange={(e) => setFormData({ ...formData, mainImageAlt: e.target.value })} className={`w-full p-2 border rounded-lg ${inputBg}`} />
                                </div>
                                <div>
                                    <label className={`block text-sm font-medium ${textColor} mb-2`}>Style Notes</label>
                                    <textarea value={formData.fullSeoDescription} onChange={(e) => setFormData({ ...formData, fullSeoDescription: e.target.value })} className={`w-full p-2 border rounded-lg ${inputBg}`} rows={4} />
                                </div>
                                <div>
                                    <label className={`block text-sm font-medium ${textColor} mb-2`}>Product Items ({formData.items?.length || 0})</label>
                                    {formData.items?.map((item, idx) => (
                                        <div key={idx} className="flex items-center gap-2 p-2 bg-stone-50 dark:bg-neutral-700 rounded-lg mb-2">
                                            <img src={item.image} alt={item.name} className="w-12 h-12 object-cover rounded" />
                                            <div className="flex-1"><p className="text-sm font-medium">{item.name}</p></div>
                                            <button onClick={() => removeItem(idx)} className="text-red-500"><Trash /></button>
                                        </div>
                                    ))}
                                    <div className="p-3 border border-dashed rounded-lg space-y-2">
                                        <input type="text" placeholder="Item Name" value={newItem.name} onChange={(e) => setNewItem({ ...newItem, name: e.target.value })} className={`w-full p-2 border rounded text-sm ${inputBg}`} />
                                        <input type="file" accept="image/*" onChange={handleItemImageUpload} className={`w-full p-2 border rounded text-sm ${inputBg}`} />
                                        {uploadingItem && <p className="text-xs text-stone-500">Uploading...</p>}
                                        <input type="text" placeholder="Or paste image URL" value={newItem.image} onChange={(e) => setNewItem({ ...newItem, image: e.target.value })} className={`w-full p-2 border rounded text-sm ${inputBg}`} />
                                        <input type="text" placeholder="Amazon Affiliate Link" value={newItem.link} onChange={(e) => setNewItem({ ...newItem, link: e.target.value })} className={`w-full p-2 border rounded text-sm ${inputBg}`} />
                                        <button onClick={addItem} disabled={!newItem.name || !newItem.image || !newItem.link} className="w-full py-2 bg-stone-200 rounded text-sm hover:bg-stone-300 disabled:opacity-50">+ Add Item</button>
                                    </div>
                                </div>
                                <div className="flex gap-3 pt-4">
                                    <button onClick={onClose} className="flex-1 py-3 border border-stone-200 rounded-lg hover:bg-stone-50">Cancel</button>
                                    <button onClick={handleSave} disabled={saving || !formData.mainImage} className="flex-1 py-3 bg-stone-800 text-white rounded-lg hover:bg-stone-900 disabled:opacity-50">{saving ? 'Saving...' : 'Save Outfit'}</button>
                                </div>
                            </div>
                        </div>
                    </div>
                );
            };

            // Main App
            const App = () => {
                const [outfits, setOutfits] = useState([]);
                const [loading, setLoading] = useState(true);
                const [user, setUser] = useState(null);
                const [darkMode, setDarkMode] = useState(() => localStorage.getItem('darkMode') === 'true');
                const [view, setView] = useState('home');
                const [selectedOutfit, setSelectedOutfit] = useState(null);
                const [selectedSeason, setSelectedSeason] = useState(null);
                const [showSearch, setShowSearch] = useState(false);
                const [searchQuery, setSearchQuery] = useState('');
                const [showMobileMenu, setShowMobileMenu] = useState(false);
                const [showLogin, setShowLogin] = useState(false);
                const [showOutfitModal, setShowOutfitModal] = useState(false);
                const [editingOutfit, setEditingOutfit] = useState(null);
                const [showBackToTop, setShowBackToTop] = useState(false);
                const [scrollPosition, setScrollPosition] = useState(0);
                const [displayCount, setDisplayCount] = useState(12);
                const [copied, setCopied] = useState(false);
                const [logoTapCount, setLogoTapCount] = useState(0);
                const [logoTapTimer, setLogoTapTimer] = useState(null);

                useEffect(() => {
                    if (darkMode) document.body.classList.add('dark');
                    else document.body.classList.remove('dark');
                    localStorage.setItem('darkMode', darkMode);
                }, [darkMode]);

                useEffect(() => {
                    const unsubAuth = auth.onAuthStateChanged(setUser);
                    return () => unsubAuth();
                }, []);

                useEffect(() => {
                    const unsubOutfits = db.collection('outfits').orderBy('dateAdded', 'desc').onSnapshot((snapshot) => {
                        setOutfits(snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() })));
                        setLoading(false);
                        // Hide loader
                        const loader = document.getElementById('initial-loader');
                        if (loader) { loader.classList.add('fade-out'); setTimeout(() => loader.remove(), 300); }
                    });
                    return () => unsubOutfits();
                }, []);

                // URL handling
                useEffect(() => {
                    const path = window.location.pathname;
                    if (path.startsWith('/outfit/')) {
                        const slug = path.replace('/outfit/', '');
                        const outfit = outfits.find(o => o.slug === slug || o.id === slug);
                        if (outfit) {
                            setSelectedOutfit(outfit);
                            document.title = `${outfit.seoTitle || 'Outfit'} - Style Finds`;
                            const updateMeta = (prop, content) => {
                                let tag = document.querySelector(`meta[property="${prop}"]`) || document.querySelector(`meta[name="${prop}"]`);
                                if (tag) tag.setAttribute('content', content);
                            };
                            updateMeta('og:title', outfit.seoTitle || 'Style Finds');
                            updateMeta('og:description', outfit.metaDescription || '');
                            updateMeta('og:image', outfit.mainImage || '');
                            updateMeta('og:url', window.location.href);
                        }
                    } else if (path === '/admin') {
                        setShowLogin(true);
                    }
                }, [outfits]);

                const filteredOutfits = useMemo(() => {
                    let filtered = outfits;
                    if (selectedSeason) filtered = filtered.filter(o => o.season === selectedSeason);
                    if (searchQuery) {
                        const q = searchQuery.toLowerCase();
                        filtered = filtered.filter(o =>
                            o.season?.toLowerCase().includes(q) ||
                            o.seoTitle?.toLowerCase().includes(q) ||
                            o.metaDescription?.toLowerCase().includes(q) ||
                            o.items?.some(i => i.name?.toLowerCase().includes(q))
                        );
                    }
                    return filtered;
                }, [outfits, selectedSeason, searchQuery]);

                const displayedOutfits = filteredOutfits.slice(0, displayCount);

                const nearbyOutfits = useMemo(() => {
                    if (!selectedOutfit) return [];
                    const idx = outfits.findIndex(o => o.id === selectedOutfit.id);
                    const nearby = [];
                    if (idx > 0) nearby.push(outfits[idx - 1]);
                    if (idx < outfits.length - 1) nearby.push(outfits[idx + 1]);
                    if (idx < outfits.length - 2) nearby.push(outfits[idx + 2]);
                    else if (idx > 1) nearby.unshift(outfits[idx - 2]);
                    return nearby.slice(0, 3);
                }, [outfits, selectedOutfit]);

                useEffect(() => {
                    const handleScroll = () => {
                        setShowBackToTop(window.pageYOffset > 500);
                        if (view === 'home' && !selectedOutfit && window.pageYOffset + window.innerHeight >= document.documentElement.scrollHeight - 500) {
                            if (displayCount < filteredOutfits.length) setDisplayCount(prev => Math.min(prev + 12, filteredOutfits.length));
                        }
                    };
                    window.addEventListener('scroll', handleScroll);
                    return () => window.removeEventListener('scroll', handleScroll);
                }, [view, selectedOutfit, displayCount, filteredOutfits.length]);

                const handleOutfitClick = (outfit) => {
                    setScrollPosition(window.pageYOffset);
                    setSelectedOutfit(null);
                    setTimeout(() => {
                        setSelectedOutfit(outfit);
                        window.scrollTo(0, 0);
                        window.history.pushState({}, '', `/outfit/${outfit.slug}`);
                        document.title = `${outfit.seoTitle || 'Outfit'} - Style Finds`;
                    }, 10);
                };

                const handleBack = () => {
                    if (selectedOutfit) {
                        setSelectedOutfit(null);
                        window.history.pushState({}, '', '/');
                        document.title = 'Daily Fashion Finds - Shop the Trendiest Styles';
                        setTimeout(() => window.scrollTo(0, scrollPosition), 0);
                    } else if (selectedSeason) {
                        setSelectedSeason(null);
                        setView('seasons');
                    } else setView('home');
                };

                const handleLogoTap = () => {
                    clearTimeout(logoTapTimer);
                    const newCount = logoTapCount + 1;
                    setLogoTapCount(newCount);
                    if (newCount >= 5) { setShowLogin(true); setLogoTapCount(0); }
                    else setLogoTapTimer(setTimeout(() => setLogoTapCount(0), 2000));
                };

                const handlePinIt = (imageUrl, description, outfitId, slug, title) => {
                    const url = `${window.location.origin}/outfit/${slug}`;
                    const pinUrl = `https://pinterest.com/pin/create/button/?url=${encodeURIComponent(url)}&media=${encodeURIComponent(imageUrl)}&description=${encodeURIComponent((title || '') + ' - ' + (description || ''))}`;
                    window.open(pinUrl, '_blank', 'width=750,height=600');
                    trackEvent('pin_click', { outfit_id: outfitId });
                };

                const copyLink = () => {
                    navigator.clipboard.writeText(window.location.href);
                    setCopied(true);
                    setTimeout(() => setCopied(false), 2000);
                    trackEvent('copy_link');
                };

                const shareToFacebook = () => {
                    window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(window.location.href)}`, '_blank', 'width=600,height=400');
                    trackEvent('facebook_share');
                };

                const shareToInstagram = () => {
                    if (/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)) {
                        navigator.clipboard.writeText(window.location.href);
                        alert('Link copied! Open Instagram and paste in your story or bio.');
                    } else {
                        alert('To share on Instagram from desktop: Take a screenshot and upload, or copy the link!\n\n' + window.location.href);
                        navigator.clipboard.writeText(window.location.href);
                    }
                    trackEvent('instagram_share');
                };

                const shareToMessenger = () => {
                    window.open(`fb-messenger://share/?link=${encodeURIComponent(window.location.href)}`, '_blank');
                    trackEvent('messenger_share');
                };

                const saveOutfit = async (data) => {
                    try {
                        if (editingOutfit && editingOutfit.id && !editingOutfit._isDuplicate) {
                            await db.collection('outfits').doc(editingOutfit.id).update(data);
                        } else {
                            await db.collection('outfits').add(data);
                        }
                        setShowOutfitModal(false);
                        setEditingOutfit(null);
                    } catch (err) { alert('Error saving: ' + err.message); }
                };

                const deleteOutfit = async (id) => {
                    if (window.confirm('Delete this outfit?')) {
                        await db.collection('outfits').doc(id).delete();
                        if (selectedOutfit?.id === id) { setSelectedOutfit(null); window.history.pushState({}, '', '/'); }
                    }
                };

                const duplicateOutfit = (outfit) => {
                    const dup = { ...outfit, seoTitle: `${outfit.seoTitle || 'Outfit'} (Copy)`, slug: `${outfit.slug}-copy-${Date.now()}`, outfitCode: outfit.outfitCode ? `${outfit.outfitCode}-copy` : '', dateAdded: new Date().toISOString(), _isDuplicate: true };
                    delete dup.id;
                    setEditingOutfit(dup);
                    setShowOutfitModal(true);
                };

                const scrollToTop = () => window.scrollTo({ top: 0, behavior: 'smooth' });

                return (
                    <div className={`min-h-screen pb-0 ${darkMode ? 'bg-neutral-900 text-neutral-100' : 'bg-white'}`}>
                        {/* Header */}
                        <header className={`sticky top-0 z-50 border-b ${darkMode ? 'bg-neutral-900 border-neutral-700' : 'bg-white border-stone-200'}`}>
                            <div className="max-w-7xl mx-auto px-4 py-3 flex items-center justify-between">
                                {selectedOutfit || view !== 'home' || selectedSeason ? (
                                    <button onClick={handleBack} className="p-2 hover:opacity-70"><ChevronLeft /></button>
                                ) : (
                                    <button onClick={() => setShowMobileMenu(!showMobileMenu)} className="p-2 hover:opacity-70">
                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>
                                    </button>
                                )}
                                <h1 onClick={handleLogoTap} className={`text-xl md:text-2xl font-light tracking-wider cursor-default select-none ${darkMode ? 'text-neutral-100' : 'text-stone-800'}`}>STYLE FINDS</h1>
                                <div className="flex items-center gap-2">
                                    <button onClick={() => setShowSearch(!showSearch)} className="p-2 hover:opacity-70"><Search /></button>
                                    <button onClick={() => setDarkMode(!darkMode)} className={`p-2 rounded-full ${darkMode ? 'text-yellow-400' : 'text-stone-600'}`}>{darkMode ? <Sun /> : <Moon />}</button>
                                    {user && <button onClick={() => { setEditingOutfit(null); setShowOutfitModal(true); }} className="p-2 bg-stone-800 text-white rounded-full dark:bg-neutral-600"><Plus /></button>}
                                </div>
                            </div>
                            {showSearch && (
                                <div className={`px-4 pb-3 ${darkMode ? 'bg-neutral-900' : 'bg-white'}`}>
                                    <input type="text" placeholder="Search outfits, seasons, items..." value={searchQuery} onChange={(e) => setSearchQuery(e.target.value)} className={`w-full px-4 py-2 border rounded-lg text-sm ${darkMode ? 'bg-neutral-800 border-neutral-600 text-white' : 'border-stone-200'}`} autoFocus />
                                </div>
                            )}
                            {showMobileMenu && (
                                <div className={`absolute top-full left-0 right-0 border-b shadow-lg ${darkMode ? 'bg-neutral-800 border-neutral-700' : 'bg-white border-stone-200'}`}>
                                    <div className="p-4 space-y-2">
                                        <button onClick={() => { setView('home'); setSelectedSeason(null); setShowMobileMenu(false); }} className={`block w-full text-left px-4 py-3 rounded-lg ${darkMode ? 'hover:bg-neutral-700' : 'hover:bg-stone-100'}`}>Home</button>
                                        <button onClick={() => { setView('seasons'); setShowMobileMenu(false); }} className={`block w-full text-left px-4 py-3 rounded-lg ${darkMode ? 'hover:bg-neutral-700' : 'hover:bg-stone-100'}`}>Shop by Season</button>
                                        <button onClick={() => { setView('accessories'); setShowMobileMenu(false); }} className={`block w-full text-left px-4 py-3 rounded-lg ${darkMode ? 'hover:bg-neutral-700' : 'hover:bg-stone-100'}`}>Accessories</button>
                                        {user && <button onClick={() => { auth.signOut(); setShowMobileMenu(false); }} className="block w-full text-left px-4 py-3 rounded-lg text-red-500">Logout</button>}
                                    </div>
                                </div>
                            )}
                        </header>

                        {/* Homepage Banner */}
                        {!selectedOutfit && (
                            <div className="max-w-7xl mx-auto px-4 pt-4">
                                <a href="https://pinterestwealthacademy.com/" target="_blank" rel="noopener noreferrer" onClick={() => trackEvent('homepage_banner_click')}
                                   className={`block w-full py-3 px-4 text-center text-sm font-medium rounded-xl border transition-all hover:shadow-md ${darkMode ? 'bg-amber-900/40 border-amber-700/50 text-amber-200 hover:bg-amber-900/50' : 'bg-[#F5EDE4] border-[#E8DDD0] text-stone-700 shadow-sm'}`}>
                                    ðŸš€ Build a $2K/Month Pinterest Side Hustle | Learn How â†’
                                </a>
                            </div>
                        )}

                        {/* Loading */}
                        {loading && <div className="flex items-center justify-center py-20"><div className="animate-pulse text-stone-400">Loading...</div></div>}

                        {/* Home Grid */}
                        {!loading && view === 'home' && !selectedOutfit && (
                            <div className="max-w-7xl mx-auto px-4 py-6">
                                <div className="masonry-grid">
                                    {displayedOutfits.map(outfit => (
                                        <div key={outfit.id} className="masonry-item group relative">
                                            <button onClick={() => handleOutfitClick(outfit)} className={`w-full relative overflow-hidden rounded-lg ${darkMode ? 'bg-neutral-800' : 'bg-stone-100'}`}>
                                                <OptimizedImage src={outfit.mainImage} alt={outfit.mainImageAlt || `${outfit.season} outfit`} className="w-full h-auto object-cover group-hover:scale-105 transition-transform duration-300" />
                                                <div className="absolute top-3 right-3 opacity-0 group-hover:opacity-100 transition-opacity hidden md:block">
                                                    <button onClick={(e) => { e.stopPropagation(); handlePinIt(outfit.mainImage, outfit.metaDescription, outfit.id, outfit.slug, outfit.seoTitle); }} className="bg-white/90 hover:bg-white p-2 rounded-full shadow-lg"><Pin /></button>
                                                </div>
                                            </button>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}

                        {/* Seasons View */}
                        {!loading && view === 'seasons' && !selectedSeason && (
                            <div className="max-w-4xl mx-auto px-4 py-12">
                                <div className="grid grid-cols-2 gap-4">
                                    {['spring', 'summer', 'fall', 'winter'].map(season => (
                                        <button key={season} onClick={() => { setSelectedSeason(season); setDisplayCount(12); }}
                                                className={`aspect-square rounded-lg flex items-center justify-center transition-colors ${darkMode ? 'bg-neutral-800 hover:bg-neutral-700' : 'bg-stone-100 hover:bg-stone-200'}`}>
                                            <span className="text-xl font-light uppercase tracking-widest">{season}</span>
                                        </button>
                                    ))}
                                </div>
                            </div>
                        )}

                        {/* Season Outfits */}
                        {!loading && selectedSeason && !selectedOutfit && (
                            <div className="max-w-7xl mx-auto px-4 py-6">
                                <h2 className="text-2xl font-light text-center mb-8 capitalize">{selectedSeason} Outfits</h2>
                                <div className="masonry-grid">
                                    {displayedOutfits.map(outfit => (
                                        <div key={outfit.id} className="masonry-item group relative">
                                            <button onClick={() => handleOutfitClick(outfit)} className={`w-full relative overflow-hidden rounded-lg ${darkMode ? 'bg-neutral-800' : 'bg-stone-100'}`}>
                                                <OptimizedImage src={outfit.mainImage} alt={outfit.mainImageAlt || `${outfit.season} outfit`} className="w-full h-auto object-cover group-hover:scale-105 transition-transform duration-300" />
                                            </button>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}

                        {/* Outfit Detail */}
                        {!loading && selectedOutfit && (
                            <div className="max-w-6xl mx-auto px-4 py-4">
                                {/* Top section */}
                                <div className="flex flex-row gap-4 md:gap-6 mb-4">
                                    <div className="relative flex-shrink-0">
                                        <div className={`w-[160px] md:w-[220px] rounded-lg overflow-hidden ${darkMode ? 'bg-neutral-800' : 'bg-stone-50'}`} style={{ aspectRatio: '2/3' }}>
                                            <OptimizedImage src={selectedOutfit.mainImage} alt={selectedOutfit.mainImageAlt || 'Outfit'} className="w-full h-full object-contain" />
                                            <button onClick={() => handlePinIt(selectedOutfit.mainImage, selectedOutfit.metaDescription, selectedOutfit.id, selectedOutfit.slug, selectedOutfit.seoTitle)} className="absolute top-2 right-2 bg-white hover:bg-white/90 p-1.5 rounded-full shadow-lg">
                                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="12" y1="17" x2="12" y2="22"></line><path d="M5 17h14v-1.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V6h1a2 2 0 0 0 0-4H8a2 2 0 0 0 0 4h1v4.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24Z"></path></svg>
                                            </button>
                                        </div>
                                    </div>
                                    <div className="flex-1 flex flex-col">
                                        <h2 className={`text-base md:text-xl font-medium mb-2 leading-tight ${darkMode ? 'text-white' : 'text-stone-800'}`}>{selectedOutfit.seoTitle || 'Shop This Look'}</h2>
                                        <p className={`text-xs md:text-sm mb-3 leading-relaxed ${darkMode ? 'text-neutral-300' : 'text-stone-600'}`}>{selectedOutfit.metaDescription || `Discover this ${selectedOutfit.season} outfit.`}</p>
                                        <p className={`text-xs font-medium mb-3 ${darkMode ? 'text-neutral-400' : 'text-stone-500'}`}>{(selectedOutfit.items || []).length} Links</p>
                                        <div className="hidden md:flex gap-2 mt-auto">
                                            <button onClick={copyLink} className={`py-1.5 px-2.5 text-xs rounded-lg flex items-center gap-1.5 ${darkMode ? 'bg-neutral-800 text-neutral-300' : 'bg-stone-100 text-stone-700'}`}>{copied ? <Check /> : <Copy />}<span>{copied ? 'Copied!' : 'Copy'}</span></button>
                                            <button onClick={shareToInstagram} className={`py-1.5 px-2.5 text-xs rounded-lg flex items-center gap-1.5 ${darkMode ? 'bg-neutral-800 text-neutral-300' : 'bg-stone-100 text-stone-700'}`}><Share2 /><span>Instagram</span></button>
                                            <button onClick={shareToFacebook} className={`py-1.5 px-2.5 text-xs rounded-lg flex items-center gap-1.5 ${darkMode ? 'bg-neutral-800 text-neutral-300' : 'bg-stone-100 text-stone-700'}`}><Share2 /><span>Facebook</span></button>
                                        </div>
                                        {user && (
                                            <div className="flex gap-2 mt-2">
                                                <button onClick={() => { setEditingOutfit(selectedOutfit); setShowOutfitModal(true); }} className="py-1 px-2 text-xs bg-stone-200 rounded flex items-center gap-1"><Edit /> Edit</button>
                                                <button onClick={() => duplicateOutfit(selectedOutfit)} className="py-1 px-2 text-xs bg-blue-100 text-blue-600 rounded flex items-center gap-1"><Duplicate /> Duplicate</button>
                                                <button onClick={() => deleteOutfit(selectedOutfit.id)} className="py-1 px-2 text-xs bg-red-100 text-red-600 rounded flex items-center gap-1"><Trash /> Delete</button>
                                            </div>
                                        )}
                                    </div>
                                </div>

                                {/* Mobile share */}
                                <div className="md:hidden grid grid-cols-4 gap-1.5 mb-3">
                                    <button onClick={copyLink} className={`py-1.5 text-xs rounded flex flex-col items-center gap-0.5 ${darkMode ? 'bg-neutral-800 text-neutral-300' : 'bg-stone-100 text-stone-700'}`}>{copied ? <Check /> : <Copy />}<span className="text-[9px]">{copied ? 'Copied' : 'Copy'}</span></button>
                                    <button onClick={shareToInstagram} className={`py-1.5 text-xs rounded flex flex-col items-center gap-0.5 ${darkMode ? 'bg-neutral-800 text-neutral-300' : 'bg-stone-100 text-stone-700'}`}><Share2 /><span className="text-[9px]">Instagram</span></button>
                                    <button onClick={shareToFacebook} className={`py-1.5 text-xs rounded flex flex-col items-center gap-0.5 ${darkMode ? 'bg-neutral-800 text-neutral-300' : 'bg-stone-100 text-stone-700'}`}><Share2 /><span className="text-[9px]">Facebook</span></button>
                                    <button onClick={shareToMessenger} className={`py-1.5 text-xs rounded flex flex-col items-center gap-0.5 ${darkMode ? 'bg-neutral-800 text-neutral-300' : 'bg-stone-100 text-stone-700'}`}><Share2 /><span className="text-[9px]">Messenger</span></button>
                                </div>

                                <div className={`border-t mb-3 ${darkMode ? 'border-neutral-700' : 'border-stone-200'}`}></div>

                                {/* Promo Banner */}
                                <a href="https://pinterestwealthacademy.com/" target="_blank" rel="noopener noreferrer" onClick={() => trackEvent('outfit_banner_click')}
                                   className={`block mb-4 p-4 rounded-xl text-center transition-all shadow-sm hover:shadow-md border ${darkMode ? 'bg-amber-900/40 border-amber-700/50 hover:bg-amber-900/50' : 'bg-[#F5EDE4] border-[#E8DDD0]'}`}>
                                    <p className={`text-sm font-medium ${darkMode ? 'text-amber-200' : 'text-stone-700'}`}>ðŸ”¥ How I Turn Outfit Pinning Into $2,847/Month â†’</p>
                                </a>

                                {/* Products */}
                                <div className="grid grid-cols-2 md:grid-cols-4 gap-3 md:gap-4">
                                    {(selectedOutfit.items || []).map((item, idx) => (
                                        <a key={idx} href={item.link} target="_blank" rel="noopener noreferrer" className={`group rounded-lg overflow-hidden transition-all hover:shadow-lg ${darkMode ? 'bg-neutral-800' : 'bg-white border border-stone-200'}`}>
                                            <div className="relative"><OptimizedImage src={item.image} alt={item.altText || item.name} className="w-full object-cover" style={{ aspectRatio: '1/1' }} /></div>
                                            <div className="p-3">
                                                <p className={`text-sm leading-snug mb-2 line-clamp-2 font-medium ${darkMode ? 'text-neutral-200' : 'text-stone-800'}`}>{item.name}</p>
                                                <p className={`text-xs ${darkMode ? 'text-neutral-400' : 'text-stone-600'}`}>Shop on Amazon â†’</p>
                                            </div>
                                        </a>
                                    ))}
                                </div>

                                {/* Style Notes */}
                                {selectedOutfit.fullSeoDescription && (
                                    <div className={`mt-10 rounded-xl overflow-hidden ${darkMode ? 'bg-neutral-800/50 border border-neutral-700' : 'bg-[#FAF8F5] border border-stone-200'}`}>
                                        <div className={`h-1 ${darkMode ? 'bg-neutral-700' : 'bg-gradient-to-r from-stone-200 via-stone-300 to-stone-200'}`}></div>
                                        <div className="p-6 md:p-8">
                                            <div className="text-center mb-6">
                                                <span className="text-xs uppercase tracking-[0.2em] text-stone-400">âœ¦</span>
                                                <h3 className={`style-notes text-xl md:text-2xl font-medium mt-2 mb-1 ${darkMode ? 'text-neutral-200' : 'text-stone-700'}`}>Style Notes</h3>
                                                <div className={`w-12 h-px mx-auto ${darkMode ? 'bg-neutral-600' : 'bg-stone-300'}`}></div>
                                            </div>
                                            <p className={`text-sm md:text-base leading-relaxed whitespace-pre-wrap ${darkMode ? 'text-neutral-300' : 'text-stone-600'}`}>{selectedOutfit.fullSeoDescription}</p>
                                        </div>
                                    </div>
                                )}

                                {/* Keep Exploring */}
                                {nearbyOutfits.length > 0 && (
                                    <div className={`mt-10 pt-8 border-t ${darkMode ? 'border-neutral-700' : 'border-stone-200'}`}>
                                        <h3 className={`text-center text-lg font-light tracking-wide mb-6 ${darkMode ? 'text-neutral-300' : 'text-stone-600'}`}>Keep Exploring</h3>
                                        <div className={`grid gap-4 ${nearbyOutfits.length === 2 ? 'grid-cols-2' : 'grid-cols-2 md:grid-cols-3'}`}>
                                            {nearbyOutfits.map(outfit => (
                                                <button key={outfit.id} onClick={() => handleOutfitClick(outfit)} className={`group rounded-lg overflow-hidden transition-all hover:shadow-lg ${darkMode ? 'bg-neutral-800' : 'bg-stone-50'}`}>
                                                    <div className="relative" style={{ aspectRatio: '2/3' }}><OptimizedImage src={outfit.mainImage} alt={outfit.mainImageAlt || 'Outfit'} className="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300" /></div>
                                                    {outfit.seoTitle && <div className="p-3"><p className={`text-xs line-clamp-2 ${darkMode ? 'text-neutral-400' : 'text-stone-500'}`}>{outfit.seoTitle}</p></div>}
                                                </button>
                                            ))}
                                        </div>
                                    </div>
                                )}

                                {/* Exit Banner */}
                                <a href="https://pinterestwealthacademy.com/" target="_blank" rel="noopener noreferrer" onClick={() => trackEvent('exit_banner_click')}
                                   className={`block mt-8 p-4 rounded-xl text-center transition-all shadow-sm hover:shadow-md border ${darkMode ? 'bg-rose-900/20 border-rose-800/50' : 'bg-[#FDF2F0] border-[#F5DDD8]'}`}>
                                    <p className={`text-sm font-medium ${darkMode ? 'text-rose-200' : 'text-stone-700'}`}>ðŸ’° Before You Go: See How to Turn Pinterest Into $2,847/Month â†’</p>
                                </a>
                            </div>
                        )}

                        {/* Back to Top */}
                        {showBackToTop && (
                            <button onClick={scrollToTop} className={`fixed bottom-8 right-8 p-3 rounded-full shadow-lg z-40 ${darkMode ? 'bg-neutral-700 text-white' : 'bg-stone-800 text-white'}`}><ArrowUp /></button>
                        )}

                        {/* Modals */}
                        {showLogin && <AdminLogin onLogin={() => setShowLogin(false)} onClose={() => setShowLogin(false)} />}
                        {showOutfitModal && <OutfitModal outfit={editingOutfit} onSave={saveOutfit} onClose={() => { setShowOutfitModal(false); setEditingOutfit(null); }} darkMode={darkMode} />}
                    </div>
                );
            };

            ReactDOM.render(<App />, document.getElementById('root'));
        }
    </script>
</body>
</html>
